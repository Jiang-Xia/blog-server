<div align="center">
	<h1>Blog Server</h1>
	<p>åŸºäº NestJS + TypeORM + MySQL + Redis çš„ç°ä»£åŒ–åšå®¢åç«¯æœåŠ¡</p>
</div>

<div align="center">

[![license](https://img.shields.io/badge/license-MIT-green.svg)](./LICENSE)
[![nestjs](https://img.shields.io/badge/NestJS-11.1.6-red.svg)](https://nestjs.com/)
[![typescript](https://img.shields.io/badge/TypeScript-5.9.2-blue.svg)](https://www.typescriptlang.org/)
[![mysql](https://img.shields.io/badge/MySQL-8.0-orange.svg)](https://www.mysql.com/)
[![redis](https://img.shields.io/badge/Redis-7.0-red.svg)](https://redis.io/)

</div>

## ğŸ“– é¡¹ç›®ç®€ä»‹

**Blog Server** æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„ç°ä»£åŒ–åšå®¢åç«¯æœåŠ¡ç³»ç»Ÿï¼Œé‡‡ç”¨ `NestJS` + `TypeScript` å¼€å‘ï¼Œä½¿ç”¨ `TypeORM` ä½œä¸º ORM æ¡†æ¶ï¼Œ`MySQL` ä½œä¸ºä¸»æ•°æ®åº“ï¼Œ`Redis` ä½œä¸ºç¼“å­˜å’Œä¼šè¯å­˜å‚¨ã€‚é¡¹ç›®æä¾›äº†å®Œæ•´çš„åšå®¢åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ–‡ç« ç®¡ç†ã€ç”¨æˆ·ç³»ç»Ÿã€è¯„è®ºå›å¤ã€æ–‡ä»¶ä¸Šä¼ ã€æƒé™ç®¡ç†ã€æ”¯ä»˜é›†æˆã€é‚®ä»¶é€šçŸ¥ã€ç¬¬ä¸‰æ–¹ç™»å½•ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

## âœ¨ ä¸»è¦ç‰¹æ€§

- ğŸš€ **ç°ä»£åŒ–æŠ€æœ¯æ ˆ**: åŸºäº NestJS 11 + TypeScript 5.9 + TypeORM + MySQL 8 + Redis
- ğŸ” **å®Œå–„çš„æƒé™ç³»ç»Ÿ**: åŸºäº RBAC çš„è§’è‰²æƒé™æ§åˆ¶ï¼Œæ”¯æŒè¶…çº§ç®¡ç†å‘˜ã€ç®¡ç†å‘˜ã€ä½œè€…ä¸‰ç§è§’è‰²ï¼Œæ”¯æŒéƒ¨é—¨ç®¡ç†
- ğŸ“ **å®Œæ•´çš„åšå®¢åŠŸèƒ½**: æ–‡ç« ç®¡ç†ã€åˆ†ç±»æ ‡ç­¾ã€è¯„è®ºå›å¤ã€ç‚¹èµã€è½¯åˆ é™¤ã€æ–‡ç« ç½®é¡¶ã€è®¿é—®ç»Ÿè®¡
- ğŸ‘¥ **ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ**: ç”¨æˆ·æ³¨å†Œç™»å½•ã€ä¸ªäººä¿¡æ¯ç®¡ç†ã€GitHub ç¬¬ä¸‰æ–¹ç™»å½•ã€é‚®ç®±éªŒè¯
- ğŸ“ **æ–‡ä»¶ç®¡ç†**: æ”¯æŒæ–‡ä»¶ä¸Šä¼ ã€æ–‡ä»¶ç®¡ç†ã€é™æ€èµ„æºæœåŠ¡
- ğŸ’¬ **äº’åŠ¨åŠŸèƒ½**: ç•™è¨€æ¿ã€è¯„è®ºå›å¤ç³»ç»Ÿã€æ–‡ç« ç‚¹èµ
- ğŸ’° **æ”¯ä»˜é›†æˆ**: æ”¯æŒæ”¯ä»˜å®æ”¯ä»˜ã€å¾®ä¿¡æ”¯ä»˜ï¼ˆé¢„ç•™ï¼‰
- ğŸ“§ **é‚®ä»¶æœåŠ¡**: æ”¯æŒé‚®ä»¶å‘é€åŠŸèƒ½ï¼ˆåŸºäº Nodemailerï¼‰
- ğŸ”’ **å®‰å…¨é˜²æŠ¤**: JWT è®¤è¯ã€å›¾å½¢éªŒè¯ç ã€å¯†ç åŠ å¯†ã€æƒé™å®ˆå«
- ğŸ“± **API æ–‡æ¡£**: é›†æˆ Swagger UI è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£
- ğŸ³ **Docker éƒ¨ç½²**: æä¾›å®Œæ•´çš„ Docker éƒ¨ç½²æ–¹æ¡ˆ
- âš¡ **æ€§èƒ½ä¼˜åŒ–**: Redis ç¼“å­˜ã€å…¨å±€æ‹¦æˆªå™¨ã€å¼‚å¸¸è¿‡æ»¤å™¨

## ğŸ—ï¸ é¡¹ç›®æ¶æ„

```
blog-server/
â”œâ”€â”€ src/                           # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ modules/                   # ä¸šåŠ¡æ¨¡å—ç›®å½•ï¼ˆæ¨¡å—åŒ–åˆ†å±‚ç®¡ç†ï¼‰
â”‚   â”‚   â”œâ”€â”€ core/                  # åŸºç¡€è®¾æ–½å±‚
â”‚   â”‚   â”‚   â””â”€â”€ redis/             # Redis å…¨å±€æ¨¡å—ï¼ˆç¼“å­˜ã€ä¼šè¯ï¼‰
â”‚   â”‚   â”œâ”€â”€ security/              # å®‰å…¨ç›¸å…³æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/              # è®¤è¯æˆæƒï¼ˆJWTã€Passportã€æƒé™å®ˆå«ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ captcha/           # å›¾å½¢éªŒè¯ç ï¼ˆsvg-captcha + Redisï¼‰
â”‚   â”‚   â”œâ”€â”€ features/              # ä¸šåŠ¡åŠŸèƒ½æ¨¡å—ï¼ˆç”± FeaturesModule ç»Ÿä¸€ç®¡ç†ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ article/           # æ–‡ç« ç®¡ç†ï¼ˆCRUDã€åˆ†ç±»ã€æ ‡ç­¾ã€ç»Ÿè®¡ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ user/              # ç”¨æˆ·ç®¡ç†ï¼ˆæ³¨å†Œã€ç™»å½•ã€èµ„æ–™ã€GitHubç™»å½•ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ admin/             # ç®¡ç†åå°ï¼ˆèœå•ç®¡ç†ã€å¤–é“¾ç®¡ç†ï¼‰
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ system/        # ç³»ç»Ÿç®¡ç†ï¼ˆè§’è‰²ã€æƒé™ã€éƒ¨é—¨ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ category/          # æ–‡ç« åˆ†ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ tag/               # æ–‡ç« æ ‡ç­¾
â”‚   â”‚   â”‚   â”œâ”€â”€ comment/           # æ–‡ç« è¯„è®º
â”‚   â”‚   â”‚   â”œâ”€â”€ reply/             # è¯„è®ºå›å¤
â”‚   â”‚   â”‚   â”œâ”€â”€ like/              # æ–‡ç« ç‚¹èµ
â”‚   â”‚   â”‚   â”œâ”€â”€ msgboard/          # ç•™è¨€æ¿
â”‚   â”‚   â”‚   â”œâ”€â”€ file/              # æ–‡ä»¶ä¸Šä¼ ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ resources/         # èµ„æºç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ email/             # é‚®ä»¶æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ pub/               # å…¬å…±æ¥å£ï¼ˆç»Ÿè®¡ã€å·¥å…·ï¼‰
â”‚   â”‚   â””â”€â”€ pay/                   # æ”¯ä»˜æ¨¡å—ï¼ˆæ”¯ä»˜å®ã€å¾®ä¿¡æ”¯ä»˜ï¼‰
â”‚   â”œâ”€â”€ config/                    # é…ç½®æ–‡ä»¶ï¼ˆæ•°æ®åº“ã€Redisã€æœåŠ¡ã€æ”¯ä»˜ç­‰ï¼‰
â”‚   â”œâ”€â”€ utils/                     # å·¥å…·å‡½æ•°ï¼ˆåŠ å¯†ã€æ—¶é—´å¤„ç†ç­‰ï¼‰
â”‚   â”œâ”€â”€ filters/                   # å…¨å±€å¼‚å¸¸è¿‡æ»¤å™¨
â”‚   â”œâ”€â”€ interceptor/               # å…¨å±€æ‹¦æˆªå™¨ï¼ˆå“åº”è½¬æ¢ï¼‰
â”‚   â”œâ”€â”€ middleware/                # ä¸­é—´ä»¶ï¼ˆç½‘å…³ä¸­é—´ä»¶ï¼‰
â”‚   â”œâ”€â”€ types/                     # TypeScript ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ app.module.ts              # æ ¹æ¨¡å—
â”‚   â””â”€â”€ main.ts                    # åº”ç”¨å…¥å£
â”œâ”€â”€ deploy/                        # éƒ¨ç½²é…ç½®ç›®å½•
â”‚   â”œâ”€â”€ front/                     # å‰ç«¯éƒ¨ç½²é…ç½®
â”‚   â”œâ”€â”€ nginx/                     # Nginx é…ç½®
â”‚   â””â”€â”€ sql/                       # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ config/                        # é¡¹ç›®é…ç½®ç›®å½•
â”‚   â”œâ”€â”€ scripts/                   # éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ nginx.conf                 # Nginx é…ç½®æ–‡ä»¶
â”œâ”€â”€ assets/                        # é™æ€èµ„æºç›®å½•
â”œâ”€â”€ public/                        # å…¬å…±èµ„æºç›®å½•ï¼ˆä¸Šä¼ æ–‡ä»¶å­˜å‚¨ï¼‰
â”‚   â”œâ”€â”€ data/                      # æ•°æ®æ–‡ä»¶
â”‚   â””â”€â”€ uploads/                   # æ–‡ä»¶ä¸Šä¼ ç›®å½•
â”œâ”€â”€ test/                          # æµ‹è¯•æ–‡ä»¶ç›®å½•
â”œâ”€â”€ backups/                       # æ•°æ®åº“å¤‡ä»½ç›®å½•
â”œâ”€â”€ coverage/                      # æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
â”œâ”€â”€ dist/                          # ç¼–è¯‘è¾“å‡ºç›®å½•
â”œâ”€â”€ .env.development               # å¼€å‘ç¯å¢ƒé…ç½®
â”œâ”€â”€ .env.production                # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ .env.test                      # æµ‹è¯•ç¯å¢ƒé…ç½®
â”œâ”€â”€ docker-compose.yml             # Docker ç¼–æ’æ–‡ä»¶
â”œâ”€â”€ docker-compose.debug.yml       # Docker è°ƒè¯•é…ç½®
â”œâ”€â”€ Dockerfile                     # Docker æ„å»ºæ–‡ä»¶
â”œâ”€â”€ ecosystem.config.js            # PM2 é…ç½®æ–‡ä»¶
â”œâ”€â”€ package.json                   # é¡¹ç›®ä¾èµ–é…ç½®
â”œâ”€â”€ tsconfig.json                  # TypeScript é…ç½®
â”œâ”€â”€ nest-cli.json                  # NestJS CLI é…ç½®
â”œâ”€â”€ eslint.config.ts               # ESLint é…ç½®
â”œâ”€â”€ commitlint.config.js           # Git æäº¤è§„èŒƒé…ç½®
â””â”€â”€ README.md                      # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

### ğŸ§© æ¨¡å—ç®¡ç†ä¸è£…é…

é¡¹ç›®é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œé€šè¿‡ `src/modules/registry.ts` ç»Ÿä¸€ç®¡ç†æ‰€æœ‰æ¨¡å—ï¼š

```typescript
// æ ¸å¿ƒæ¨¡å—
export const CoreModules = [RedisModule];

// å®‰å…¨æ¨¡å—
export const SecurityModules = [AuthModule, CaptchaModule];

// ä¸šåŠ¡åŠŸèƒ½æ¨¡å—
export const FeatureModules = [FeaturesModule.register()];

// æ‰€æœ‰æ¨¡å—
export const AllAppModules = [...CoreModules, ...SecurityModules, ...FeatureModules, PayModule];
```

**æ¨¡å—è¯´æ˜**ï¼š

- **æ ¸å¿ƒæ¨¡å— (CoreModules)**ï¼š`RedisModule` ä¸ºå…¨å±€æ¨¡å—ï¼Œæä¾› Redis ç¼“å­˜å’Œä¼šè¯ç®¡ç†èƒ½åŠ›
- **å®‰å…¨æ¨¡å— (SecurityModules)**ï¼š
  - `AuthModule`ï¼šJWT è®¤è¯ã€Passport ç­–ç•¥ã€æƒé™å®ˆå«
  - `CaptchaModule`ï¼šå›¾å½¢éªŒè¯ç ç”Ÿæˆä¸æ ¡éªŒï¼ˆåŸºäº svg-captcha + Redisï¼‰
- **ä¸šåŠ¡åŠŸèƒ½æ¨¡å— (FeatureModules)**ï¼šç”± `FeaturesModule` ç»Ÿä¸€è£…é…ï¼ŒåŒ…å« 12 ä¸ªå­æ¨¡å—ï¼ˆæ–‡ç« ã€ç”¨æˆ·ã€è¯„è®ºã€æ ‡ç­¾ç­‰ï¼‰
- **æ”¯ä»˜æ¨¡å— (PayModule)**ï¼šæ”¯ä»˜å®æ”¯ä»˜ã€å¾®ä¿¡æ”¯ä»˜é›†æˆ

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯æ¡†æ¶
- **[NestJS 11](https://nestjs.com/)** - æ¸è¿›å¼ Node.js æ¡†æ¶ï¼Œæä¾›ä¾èµ–æ³¨å…¥ã€æ¨¡å—åŒ–ç­‰ä¼ä¸šçº§ç‰¹æ€§
- **[TypeScript 5.9](https://www.typescriptlang.org/)** - å¼ºç±»å‹ JavaScript è¶…é›†
- **[TypeORM 0.3](https://typeorm.io/)** - å¼ºå¤§çš„ ORM æ¡†æ¶ï¼Œæ”¯æŒ MySQLã€PostgreSQL ç­‰å¤šç§æ•°æ®åº“

### æ•°æ®åº“ä¸ç¼“å­˜
- **[MySQL 8.0](https://www.mysql.com/)** - å…³ç³»å‹æ•°æ®åº“ï¼Œå­˜å‚¨æ ¸å¿ƒä¸šåŠ¡æ•°æ®
- **[Redis 7.0](https://redis.io/)** - å†…å­˜æ•°æ®åº“ï¼Œç”¨äºç¼“å­˜å’Œä¼šè¯ç®¡ç†ï¼ˆåŸºäº ioredisï¼‰

### è®¤è¯æˆæƒ
- **[Passport](http://www.passportjs.org/)** - èº«ä»½éªŒè¯ä¸­é—´ä»¶
  - passport-jwt - JWT ç­–ç•¥
  - passport-local - æœ¬åœ°ç”¨æˆ·åå¯†ç ç­–ç•¥
  - passport-github2 - GitHub OAuth ç™»å½•
- **[@nestjs/jwt](https://docs.nestjs.com/security/authentication)** - JWT ä»¤ç‰Œç”Ÿæˆä¸éªŒè¯
- **crypto-js** - å¯†ç åŠ å¯†
- **node-jsencrypt** - RSA åŠ å¯†

### éªŒè¯ä¸æ–‡æ¡£
- **[Swagger UI](https://swagger.io/tools/swagger-ui/)** - è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ï¼ˆ@nestjs/swaggerï¼‰
- **[class-validator](https://github.com/typestack/class-validator)** - DTO æ•°æ®éªŒè¯
- **[class-transformer](https://github.com/typestack/class-transformer)** - å¯¹è±¡è½¬æ¢

### ç¬¬ä¸‰æ–¹æœåŠ¡
- **[Nodemailer](https://nodemailer.com/)** - é‚®ä»¶å‘é€æœåŠ¡ï¼ˆæ”¯æŒ SMTPï¼‰
- **[alipay-sdk](https://github.com/alipay/alipay-sdk-nodejs-all)** - æ”¯ä»˜å®æ”¯ä»˜ SDK
- **[svg-captcha](https://github.com/produck/svg-captcha)** - å›¾å½¢éªŒè¯ç ç”Ÿæˆ
- **[marked](https://marked.js.org/)** - Markdown è§£æå™¨

### å·¥å…·åº“
- **[axios](https://axios-http.com/)** - HTTP å®¢æˆ·ç«¯ï¼ˆ@nestjs/axiosï¼‰
- **[dayjs](https://day.js.org/)** - æ—¥æœŸæ—¶é—´å¤„ç†
- **[ua-parser-js](https://github.com/faisalman/ua-parser-js)** - User-Agent è§£æ
- **[request-ip](https://github.com/pbojinov/request-ip)** - IP åœ°å€è·å–
- **[uuid](https://github.com/uuidjs/uuid)** - UUID ç”Ÿæˆ
- **[multer](https://github.com/expressjs/multer)** - æ–‡ä»¶ä¸Šä¼ ä¸­é—´ä»¶

### ä»»åŠ¡è°ƒåº¦
- **[@nestjs/schedule](https://docs.nestjs.com/techniques/task-scheduling)** - å®šæ—¶ä»»åŠ¡ï¼ˆåŸºäº cronï¼‰

### ä»£ç è´¨é‡
- **[ESLint](https://eslint.org/)** - ä»£ç æ£€æŸ¥å·¥å…·
- **[Prettier](https://prettier.io/)** - ä»£ç æ ¼å¼åŒ–å·¥å…·
- **[Commitlint](https://commitlint.js.org/)** - Git æäº¤ä¿¡æ¯è§„èŒƒ
- **[Husky](https://typicode.github.io/husky/)** - Git hooks å·¥å…·
- **[Jest](https://jestjs.io/)** - å•å…ƒæµ‹è¯•æ¡†æ¶

### éƒ¨ç½²å’Œè¿ç»´
- **[Docker](https://www.docker.com/)** - å®¹å™¨åŒ–éƒ¨ç½²
- **[PM2](https://pm2.keymetrics.io/)** - Node.js è¿›ç¨‹ç®¡ç†å™¨
- **[Nginx](https://nginx.org/)** - åå‘ä»£ç†å’Œé™æ€èµ„æºæœåŠ¡å™¨

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Node.js** >= 16.0.0ï¼ˆæ¨è 18.x æˆ– 20.xï¼‰
- **MySQL** >= 8.0
- **Redis** >= 5.0ï¼ˆæ¨è 7.xï¼‰
- **Docker** >= 20.10ï¼ˆå¯é€‰ï¼Œç”¨äºå®¹å™¨åŒ–éƒ¨ç½²ï¼‰
- **npm** >= 8.0 æˆ– **yarn** >= 1.22

### å®‰è£…ä¾èµ–

```bash
# ä½¿ç”¨ npm
npm install

# ä½¿ç”¨ yarn
yarn install
```

### ç¯å¢ƒé…ç½®

1. **åˆ›å»ºç¯å¢ƒé…ç½®æ–‡ä»¶**

é¡¹ç›®æ ¹ç›®å½•å·²åŒ…å«ä¸‰ä¸ªç¯å¢ƒé…ç½®æ¨¡æ¿ï¼š
- `.env.development` - å¼€å‘ç¯å¢ƒ
- `.env.production` - ç”Ÿäº§ç¯å¢ƒ
- `.env.test` - æµ‹è¯•ç¯å¢ƒ

æ ¹æ®éœ€è¦ä¿®æ”¹å¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼š

```env
# æ•°æ®åº“é…ç½®
db_host = 127.0.0.1
db_port = 3306
db_username = your_username
db_password = 'your_password'
db_database = myblog
db_synchronize = true  # ç”Ÿäº§ç¯å¢ƒåŠ¡å¿…è®¾ç½®ä¸º false
db_logging = 'error'

# Redis é…ç½®
redis_host = 127.0.0.1
redis_port = 6379
redis_db = 1

# æœåŠ¡é…ç½®
serve_port = 5000
serve_apiPath = api/v1
serve_baseUrl = http://127.0.0.1:5000

# åˆå§‹ç®¡ç†å‘˜è´¦å·
account_mobile = 18888888888
account_password = super
account_role = super
account_nickname = super

# æ–‡ä»¶ä¸Šä¼ é…ç½®
file_filePath = ./public/uploads/

# é‚®ä»¶æœåŠ¡é…ç½®ï¼ˆå¯é€‰ï¼‰
app_emailHost = smtp.163.com
app_emailPort = 465
app_emailUser = your_email@163.com
app_emailPass = your_email_auth_code

# GitHub ç™»å½•é…ç½®ï¼ˆå¯é€‰ï¼‰
app_githubClientId = your_github_client_id
app_githubClientSecret = your_github_client_secret
app_githubCallbackUrl = http://127.0.0.1:5000/api/v1/user/auth/github/callback

# æ”¯ä»˜å®é…ç½®ï¼ˆå¯é€‰ï¼‰
pay_alipayAppId = your_alipay_app_id
pay_alipayPrivateKey = your_private_key
pay_alipayPublicKey = your_public_key
pay_alipayGateway = https://openapi.alipay.com/gateway.do
```

2. **åˆ›å»ºæ•°æ®åº“**

```sql
CREATE DATABASE myblog CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
```

å¦‚éœ€ä½¿ç”¨åˆå§‹åŒ–è„šæœ¬ï¼Œå¯å¯¼å…¥ `deploy/sql/init.sql`ï¼š

```bash
# æ–¹å¼ä¸€ï¼šä½¿ç”¨ mysql å‘½ä»¤å¯¼å…¥
mysql -u your_username -p myblog < deploy/sql/init.sql

# æ–¹å¼äºŒï¼šè¿›å…¥ mysql åä½¿ç”¨ source å‘½ä»¤
mysql -u your_username -p
USE myblog;
source deploy/sql/init.sql;
```

> **é‡è¦æç¤º**ï¼š
> - **å¼€å‘ç¯å¢ƒ**ï¼šå¦‚æœ `db_synchronize=true`ï¼Œé¦–æ¬¡å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“è¡¨ç»“æ„
> - **ç”Ÿäº§ç¯å¢ƒ**ï¼šå¿…é¡»è®¾ç½® `db_synchronize=false`ï¼Œä½¿ç”¨ `init.sql` è„šæœ¬æ‰‹åŠ¨åˆå§‹åŒ–
> - **init.sql è„šæœ¬å†…å®¹**ï¼šåŒ…å«å®Œæ•´çš„è¡¨ç»“æ„ã€è§’è‰²ã€æƒé™ã€èœå•ã€éƒ¨é—¨ç­‰åˆå§‹æ•°æ®
> - **ç”¨æˆ·è´¦å·**ï¼šé¦–æ¬¡å¯åŠ¨æœåŠ¡æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºé»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼ˆæ‰‹æœºå·ï¼š18888888888ï¼Œå¯†ç ï¼šsuperï¼‰
> - **è¯¦ç»†è¯´æ˜**ï¼šè¯·æŸ¥çœ‹ä¸‹æ–‡ã€Œåˆå§‹åŒ–æ•°æ®ã€ç« èŠ‚

### å¯åŠ¨æœåŠ¡

```bash
# å¼€å‘æ¨¡å¼ï¼ˆçƒ­é‡è½½ï¼‰
npm run start:dev

# ç”Ÿäº§æ¨¡å¼
npm run build
npm run start:prod

# è°ƒè¯•æ¨¡å¼
npm run start:debug

# ä½¿ç”¨ PM2 å¯åŠ¨
npm run pm2:dev      # å¼€å‘ç¯å¢ƒ
npm run pm2:prod     # ç”Ÿäº§ç¯å¢ƒ
npm run pm2:test     # æµ‹è¯•ç¯å¢ƒ
```

æœåŠ¡å¯åŠ¨æˆåŠŸåï¼Œè®¿é—®ï¼š
- **API æ¥å£**ï¼šhttp://localhost:5000/api/v1
- **Swagger æ–‡æ¡£**ï¼šhttp://localhost:5000/api/v1/doc

### Docker éƒ¨ç½²

```bash
# å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆåŒ…æ‹¬ MySQL å’Œ Redisï¼‰
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f blog-server

# åœæ­¢æœåŠ¡
docker-compose down

# åœæ­¢å¹¶æ¸…é™¤æ•°æ®
docker-compose down -v
```

### å¼€å‘è°ƒè¯•

```bash
# ä»£ç æ ¼å¼åŒ–
npm run format

# ä»£ç æ£€æŸ¥
npm run lint

# è‡ªåŠ¨ä¿®å¤
npm run lint:fix

# è¿è¡Œæµ‹è¯•
npm run test

# æµ‹è¯•è¦†ç›–ç‡
npm run test:cov

# E2E æµ‹è¯•
npm run test:e2e
```

## ğŸ“‹ åŠŸèƒ½æ¨¡å—

### ğŸ” è®¤è¯æˆæƒæ¨¡å— (`security/auth`, `security/captcha`)

**è®¤è¯æˆæƒ (AuthModule)**ï¼š
- âœ… JWT ä»¤ç‰Œè®¤è¯ï¼ˆåŸºäº @nestjs/jwt å’Œ passport-jwtï¼‰
- âœ… æœ¬åœ°ç”¨æˆ·åå¯†ç ç™»å½•ï¼ˆpassport-localï¼‰
- âœ… GitHub ç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆpassport-github2ï¼‰
- âœ… åŸºäº RBAC çš„è§’è‰²æƒé™æ§åˆ¶ï¼ˆsuper/admin/authorï¼‰
- âœ… å…¨å±€æƒé™å®ˆå«ï¼ˆPermissionGuardï¼‰
- âœ… å¯†ç åŠ å¯†å­˜å‚¨ï¼ˆcrypto-js + saltï¼‰

**å›¾å½¢éªŒè¯ç  (CaptchaModule)**ï¼š
- âœ… å›¾å½¢éªŒè¯ç ç”Ÿæˆï¼ˆsvg-captchaï¼‰
- âœ… Redis å­˜å‚¨éªŒè¯ç ï¼ˆ5 åˆ†é’Ÿè¿‡æœŸï¼‰
- âœ… éªŒè¯ç æ ¡éªŒæ¥å£

### ğŸ“ æ–‡ç« ç®¡ç†æ¨¡å— (`features/article`)

- âœ… æ–‡ç«  CRUDï¼ˆåˆ›å»ºã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ï¼‰
- âœ… æ–‡ç« åˆ†ç±»å’Œæ ‡ç­¾å…³è”ï¼ˆå¤šå¯¹å¤šå…³ç³»ï¼‰
- âœ… æ–‡ç« çŠ¶æ€ç®¡ç†ï¼ˆè‰ç¨¿ã€å·²å‘å¸ƒï¼‰
- âœ… æ–‡ç« ç½®é¡¶åŠŸèƒ½
- âœ… è½¯åˆ é™¤ï¼ˆisDelete æ ‡è®°ï¼‰
- âœ… æ–‡ç« è®¿é—®é‡ç»Ÿè®¡ï¼ˆviewsï¼‰
- âœ… æ–‡ç« ç‚¹èµç»Ÿè®¡ï¼ˆlikesï¼‰
- âœ… æ–‡ç« å½’æ¡£ï¼ˆæŒ‰å¹´æœˆåˆ†ç»„ï¼‰
- âœ… æ–‡ç« æœç´¢å’Œåˆ†é¡µ
- âœ… Markdown å†…å®¹è§£æï¼ˆmarkedï¼‰
- âœ… æ–‡ç« å°é¢å›¾

**æ•°æ®åº“å…³ç³»**ï¼š
- Article - User (å¤šå¯¹ä¸€)
- Article - Category (å¤šå¯¹ä¸€)
- Article - Tag (å¤šå¯¹å¤š)
- Article - Comment (ä¸€å¯¹å¤š)
- Article - Like (ä¸€å¯¹å¤š)

### ğŸ‘¥ ç”¨æˆ·ç®¡ç†æ¨¡å— (`features/user`)

- âœ… ç”¨æˆ·æ³¨å†Œï¼ˆæ‰‹æœºå·/é‚®ç®±ï¼‰
- âœ… ç”¨æˆ·ç™»å½•ï¼ˆæœ¬åœ°ç™»å½• + GitHub OAuthï¼‰
- âœ… ç”¨æˆ·ä¿¡æ¯ç®¡ç†ï¼ˆæ˜µç§°ã€å¤´åƒã€ä¸ªäººç®€ä»‹ï¼‰
- âœ… ç”¨æˆ·åˆ—è¡¨ç®¡ç†ï¼ˆåˆ†é¡µã€æœç´¢ï¼‰
- âœ… ç”¨æˆ·çŠ¶æ€ç®¡ç†ï¼ˆactive/lockedï¼‰
- âœ… ç”¨æˆ·è§’è‰²å…³è”ï¼ˆå¤šå¯¹å¤šï¼‰
- âœ… ç”¨æˆ·éƒ¨é—¨å…³è”ï¼ˆå¤šå¯¹ä¸€ï¼‰
- âœ… å¯†ç ä¿®æ”¹
- âœ… ç”¨æˆ·è½¯åˆ é™¤

### ğŸ·ï¸ åˆ†ç±»æ ‡ç­¾æ¨¡å— (`features/category`, `features/tag`)

**åˆ†ç±»ç®¡ç† (CategoryModule)**ï¼š
- âœ… åˆ†ç±» CRUD
- âœ… åˆ†ç±»é¢œè‰²æ ‡è®°
- âœ… ä¸€ä¸ªåˆ†ç±»åŒ…å«å¤šç¯‡æ–‡ç« 
- âœ… åˆ†ç±»ç»Ÿè®¡ï¼ˆæ–‡ç« æ•°é‡ï¼‰

**æ ‡ç­¾ç®¡ç† (TagModule)**ï¼š
- âœ… æ ‡ç­¾ CRUD
- âœ… æ ‡ç­¾é¢œè‰²æ ‡è®°
- âœ… å¤šå¯¹å¤šæ–‡ç« å…³è”
- âœ… æ ‡ç­¾ç»Ÿè®¡ï¼ˆæ–‡ç« æ•°é‡ï¼‰

### ğŸ’¬ è¯„è®ºç³»ç»Ÿæ¨¡å— (`features/comment`, `features/reply`)

**è¯„è®ºç®¡ç† (CommentModule)**ï¼š
- âœ… æ–‡ç« è¯„è®ºåŠŸèƒ½
- âœ… è¯„è®º CRUD
- âœ… è¯„è®ºä¸ç”¨æˆ·å…³è”
- âœ… è¯„è®ºä¸æ–‡ç« å…³è”
- âœ… è¯„è®ºåˆ—è¡¨åˆ†é¡µ

**å›å¤ç®¡ç† (ReplyModule)**ï¼š
- âœ… è¯„è®ºå›å¤åŠŸèƒ½
- âœ… å›å¤ CRUD
- âœ… å›å¤åµŒå¥—å±‚çº§

### ğŸ‘ äº’åŠ¨åŠŸèƒ½æ¨¡å— (`features/like`, `features/msgboard`)

**ç‚¹èµæ¨¡å— (LikeModule)**ï¼š
- âœ… æ–‡ç« ç‚¹èµ/å–æ¶ˆç‚¹èµ
- âœ… ç‚¹èµç”¨æˆ·è®°å½•
- âœ… ç‚¹èµç»Ÿè®¡

**ç•™è¨€æ¿æ¨¡å— (MsgboardModule)**ï¼š
- âœ… ç•™è¨€å‘å¸ƒ
- âœ… ç•™è¨€ CRUD
- âœ… ç•™è¨€åˆ—è¡¨åˆ†é¡µ

### ğŸ“ æ–‡ä»¶ç®¡ç†æ¨¡å— (`features/file`)

- âœ… æ–‡ä»¶ä¸Šä¼ ï¼ˆåŸºäº multerï¼‰
- âœ… æ”¯æŒå›¾ç‰‡ã€æ–‡æ¡£ç­‰å¤šç§æ ¼å¼
- âœ… æ–‡ä»¶å­˜å‚¨åˆ°æœ¬åœ° `public/uploads/`
- âœ… æ–‡ä»¶åˆ—è¡¨ç®¡ç†
- âœ… æ–‡ä»¶åˆ é™¤
- âœ… é™æ€èµ„æºæœåŠ¡ï¼ˆé€šè¿‡ `/static/` è®¿é—®ï¼‰

### ğŸ“§ é‚®ä»¶æœåŠ¡æ¨¡å— (`features/email`)

- âœ… é‚®ä»¶å‘é€åŠŸèƒ½ï¼ˆåŸºäº Nodemailerï¼‰
- âœ… æ”¯æŒ SMTP åè®®
- âœ… HTML é‚®ä»¶æ¨¡æ¿
- âœ… é‚®ä»¶éªŒè¯ç å‘é€

### ğŸ“¦ èµ„æºç®¡ç†æ¨¡å— (`features/resources`)

- âœ… èµ„æº CRUD
- âœ… èµ„æºåˆ†ç±»ç®¡ç†
- âœ… èµ„æºæœç´¢å’Œç­›é€‰

### âš™ï¸ ç®¡ç†åå°æ¨¡å— (`features/admin`)

**èœå•ç®¡ç† (AdminModule)**ï¼š
- âœ… èœå• CRUD
- âœ… èœå•æ ‘å½¢ç»“æ„
- âœ… èœå•æ’åº
- âœ… å¤–é“¾ç®¡ç†
- âœ… èœå•æƒé™æ§åˆ¶

**ç³»ç»Ÿç®¡ç† (SystemModule)**ï¼š

- **è§’è‰²ç®¡ç† (RoleController)**ï¼š
  - âœ… è§’è‰² CRUD
  - âœ… è§’è‰²æƒé™å…³è”
  - âœ… è§’è‰²ä¸ç”¨æˆ·å¤šå¯¹å¤šå…³è”

- **æƒé™ç®¡ç† (PrivilegeController)**ï¼š
  - âœ… æƒé™ CRUD
  - âœ… æƒé™æ ‘å½¢ç»“æ„
  - âœ… æ¥å£æƒé™æ§åˆ¶

- **éƒ¨é—¨ç®¡ç† (DeptController)**ï¼š
  - âœ… éƒ¨é—¨ CRUD
  - âœ… éƒ¨é—¨æ ‘å½¢ç»“æ„
  - âœ… éƒ¨é—¨ä¸ç”¨æˆ·å…³è”

### ğŸ’° æ”¯ä»˜æ¨¡å— (`pay`)

- âœ… æ”¯ä»˜å®æ”¯ä»˜é›†æˆï¼ˆalipay-sdkï¼‰
  - åˆ›å»ºè®¢å•
  - æ”¯ä»˜å›è°ƒå¤„ç†
  - è®¢å•æŸ¥è¯¢
- â³ å¾®ä¿¡æ”¯ä»˜ï¼ˆé¢„ç•™æ¥å£ï¼‰

### ğŸŒ å…¬å…±æ¥å£æ¨¡å— (`features/pub`)

- âœ… ç½‘ç«™ç»Ÿè®¡ï¼ˆæ–‡ç« æ•°ã€ç”¨æˆ·æ•°ã€è®¿é—®é‡ç­‰ï¼‰
- âœ… IP åœ°å€è§£æ
- âœ… User-Agent è§£æ
- âœ… é«˜å¾·åœ°å›¾ API é›†æˆ
- âœ… å…¬å…±å·¥å…·æ¥å£

## ğŸ”§ å¼€å‘æŒ‡å—

### ä»£ç è§„èŒƒ

é¡¹ç›®ä½¿ç”¨ **ESLint** + **Prettier** + **Husky** + **lint-staged** è¿›è¡Œä»£ç è´¨é‡æ§åˆ¶ï¼š

```bash
# ä»£ç æ ¼å¼åŒ–
npm run format

# ä»£ç æ£€æŸ¥
npm run lint

# è‡ªåŠ¨ä¿®å¤ ESLint é”™è¯¯
npm run lint:fix
```

**é…ç½®æ–‡ä»¶**ï¼š
- `eslint.config.ts` - ESLint é…ç½®ï¼ˆTypeScript ESLintï¼‰
- `.prettierrc.json` - Prettier é…ç½®
- `.prettierignore` - Prettier å¿½ç•¥æ–‡ä»¶
- `commitlint.config.js` - æäº¤ä¿¡æ¯è§„èŒƒ

**Git Hooks**ï¼ˆé€šè¿‡ Husky è‡ªåŠ¨è§¦å‘ï¼‰ï¼š
- `pre-commit`ï¼šæäº¤å‰è‡ªåŠ¨æ‰§è¡Œ `lint-staged`ï¼ˆæ ¼å¼åŒ–å’Œæ£€æŸ¥æš‚å­˜çš„æ–‡ä»¶ï¼‰
- `commit-msg`ï¼šæ ¡éªŒæäº¤ä¿¡æ¯æ˜¯å¦ç¬¦åˆè§„èŒƒ

### æäº¤è§„èŒƒ

é¡¹ç›®ä½¿ç”¨ **Commitlint** + **@commitlint/config-conventional** è¿›è¡Œæäº¤ä¿¡æ¯è§„èŒƒï¼š

**æäº¤æ ¼å¼**ï¼š
```
<type>(<scope>): <subject>

<body>

<footer>
```

**Type ç±»å‹**ï¼š
- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¤ bug
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼è°ƒæ•´ï¼ˆä¸å½±å“ä»£ç é€»è¾‘ï¼‰
- `refactor`: é‡æ„ï¼ˆæ—¢ä¸æ˜¯æ–°åŠŸèƒ½ä¹Ÿä¸æ˜¯ä¿®å¤ bugï¼‰
- `perf`: æ€§èƒ½ä¼˜åŒ–
- `test`: æµ‹è¯•ç›¸å…³
- `build`: æ„å»ºç³»ç»Ÿæˆ–å¤–éƒ¨ä¾èµ–å˜æ›´
- `ci`: CI é…ç½®æ–‡ä»¶å’Œè„šæœ¬å˜æ›´
- `chore`: å…¶ä»–ä¸ä¿®æ”¹ src æˆ– test çš„å˜æ›´
- `revert`: å›æ»šä¹‹å‰çš„æäº¤

**æäº¤ç¤ºä¾‹**ï¼š
```bash
# æ–°åŠŸèƒ½
git commit -m "feat(auth): æ·»åŠ  GitHub ç¬¬ä¸‰æ–¹ç™»å½•åŠŸèƒ½"

# ä¿®å¤ bug
git commit -m "fix(article): ä¿®å¤æ–‡ç« åˆ—è¡¨åˆ†é¡µé—®é¢˜"

# æ–‡æ¡£æ›´æ–°
git commit -m "docs: æ›´æ–° README å’Œ API æ–‡æ¡£"

# ä»£ç é‡æ„
git commit -m "refactor(user): ä¼˜åŒ–ç”¨æˆ·æ¨¡å—ä»£ç ç»“æ„"

# æ€§èƒ½ä¼˜åŒ–
git commit -m "perf(redis): ä¼˜åŒ– Redis ç¼“å­˜ç­–ç•¥"
```

### å¼€å‘æµç¨‹

1. **åˆ›å»ºåŠŸèƒ½åˆ†æ”¯**
```bash
git checkout -b feature/your-feature-name
```

2. **å¼€å‘å¹¶æµ‹è¯•**
```bash
npm run start:dev
npm run test
```

3. **æäº¤ä»£ç **ï¼ˆè‡ªåŠ¨è§¦å‘ä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–ï¼‰
```bash
git add .
git commit -m "feat: ä½ çš„åŠŸèƒ½æè¿°"
```

4. **æ¨é€å¹¶åˆ›å»º Pull Request**
```bash
git push origin feature/your-feature-name
```

### æµ‹è¯•è§„èŒƒ

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test

# ç›‘å¬æ¨¡å¼ï¼ˆå¼€å‘æ—¶ä½¿ç”¨ï¼‰
npm run test:watch

# ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
npm run test:cov

# è°ƒè¯•æµ‹è¯•
npm run test:debug

# E2E æµ‹è¯•
npm run test:e2e
```

æµ‹è¯•æ–‡ä»¶å‘½åè§„èŒƒï¼š`*.spec.ts`

### ç›®å½•ç»“æ„è§„èŒƒ

**æ¨¡å—ç›®å½•ç»“æ„**ï¼š
```
modules/features/article/
â”œâ”€â”€ dto/                    # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”œâ”€â”€ create-article.dto.ts
â”‚   â””â”€â”€ update-article.dto.ts
â”œâ”€â”€ entity/                 # æ•°æ®åº“å®ä½“
â”‚   â””â”€â”€ article.entity.ts
â”œâ”€â”€ article.controller.ts   # æ§åˆ¶å™¨
â”œâ”€â”€ article.service.ts      # æœåŠ¡å±‚
â”œâ”€â”€ article.module.ts       # æ¨¡å—å®šä¹‰
â””â”€â”€ article.spec.ts         # å•å…ƒæµ‹è¯•
```

**å‘½åè§„èŒƒ**ï¼š
- æ–‡ä»¶åï¼škebab-caseï¼ˆå¦‚ï¼š`user-profile.service.ts`ï¼‰
- ç±»åï¼šPascalCaseï¼ˆå¦‚ï¼š`UserProfileService`ï¼‰
- å˜é‡/å‡½æ•°ï¼šcamelCaseï¼ˆå¦‚ï¼š`getUserProfile`ï¼‰
- å¸¸é‡ï¼šUPPER_SNAKE_CASEï¼ˆå¦‚ï¼š`MAX_FILE_SIZE`ï¼‰
- æ¥å£ï¼šPascalCaseï¼Œå‰ç¼€ `I`ï¼ˆå¦‚ï¼š`IUserProfile`ï¼‰
- æšä¸¾ï¼šPascalCaseï¼ˆå¦‚ï¼š`UserStatus`ï¼‰

## ğŸ“š API æ–‡æ¡£

é¡¹ç›®é›†æˆäº† **Swagger UI**ï¼Œè‡ªåŠ¨ç”Ÿæˆå®Œæ•´çš„ API æ–‡æ¡£ï¼ˆåŸºäº @nestjs/swaggerï¼‰ã€‚

å¯åŠ¨æœåŠ¡åï¼Œè®¿é—®ä»¥ä¸‹åœ°å€ï¼š

- **Swagger UI**ï¼šhttp://localhost:5000/api/v1/doc
- **API æ¥å£æ ¹è·¯å¾„**ï¼šhttp://localhost:5000/api/v1

**æ–‡æ¡£ç‰¹æ€§**ï¼š
- âœ… è‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰æ¥å£æ–‡æ¡£
- âœ… æ”¯æŒåœ¨çº¿è°ƒè¯•ï¼ˆTry it outï¼‰
- âœ… JWT è®¤è¯æ”¯æŒï¼ˆç‚¹å‡»å³ä¸Šè§’ Authorize è¾“å…¥ Bearer Tokenï¼‰
- âœ… DTO éªŒè¯è§„åˆ™å±•ç¤º
- âœ… è¯·æ±‚/å“åº”ç¤ºä¾‹

**ä¸»è¦æ¥å£åˆ†ç»„**ï¼š

| åˆ†ç»„ | è·¯å¾„å‰ç¼€ | è¯´æ˜ |
|------|---------|------|
| è®¤è¯æˆæƒ | `/api/v1/auth` | ç™»å½•ã€æ³¨å†Œã€JWT éªŒè¯ |
| ç”¨æˆ·ç®¡ç† | `/api/v1/user` | ç”¨æˆ· CRUDã€èµ„æ–™ç®¡ç† |
| æ–‡ç« ç®¡ç† | `/api/v1/article` | æ–‡ç«  CRUDã€åˆ†ç±»ã€æ ‡ç­¾ |
| åˆ†ç±»ç®¡ç† | `/api/v1/category` | åˆ†ç±» CRUD |
| æ ‡ç­¾ç®¡ç† | `/api/v1/tag` | æ ‡ç­¾ CRUD |
| è¯„è®ºç®¡ç† | `/api/v1/comment` | è¯„è®º CRUD |
| å›å¤ç®¡ç† | `/api/v1/reply` | å›å¤ CRUD |
| ç‚¹èµç®¡ç† | `/api/v1/like` | ç‚¹èµ/å–æ¶ˆç‚¹èµ |
| ç•™è¨€æ¿ | `/api/v1/msgboard` | ç•™è¨€ CRUD |
| æ–‡ä»¶ç®¡ç† | `/api/v1/file` | æ–‡ä»¶ä¸Šä¼ ã€ç®¡ç† |
| ç®¡ç†åå° | `/api/v1/admin` | èœå•ã€å¤–é“¾ç®¡ç† |
| ç³»ç»Ÿç®¡ç† | `/api/v1/admin/system` | è§’è‰²ã€æƒé™ã€éƒ¨é—¨ |
| æ”¯ä»˜ç®¡ç† | `/api/v1/pay` | æ”¯ä»˜å®æ”¯ä»˜ |
| éªŒè¯ç  | `/api/v1/captcha` | å›¾å½¢éªŒè¯ç  |
| å…¬å…±æ¥å£ | `/api/v1/pub` | ç»Ÿè®¡ã€å·¥å…·æ¥å£ |

## ğŸ“Š æ•°æ®åº“è®¾è®¡

**æ ¸å¿ƒæ•°æ®è¡¨**ï¼š

| è¡¨å | è¯´æ˜ | å…³é”®å­—æ®µ |
|------|------|----------|
| `user` | ç”¨æˆ·è¡¨ | id, mobile, email, nickname, avatar, password, salt, status, roles, deptId |
| `article` | æ–‡ç« è¡¨ | id, title, content, cover, status, likes, views, topping, isDelete, uid, category, tags |
| `category` | åˆ†ç±»è¡¨ | id, label, value, color, uid |
| `tag` | æ ‡ç­¾è¡¨ | id, label, value, color, uid |
| `comment` | è¯„è®ºè¡¨ | id, content, uid, articleId, userId |
| `reply` | å›å¤è¡¨ | id, content, commentId, userId |
| `like` | ç‚¹èµè¡¨ | id, uid, articleId |
| `msgboard` | ç•™è¨€æ¿è¡¨ | id, content, uid |
| `menu` | èœå•è¡¨ | id, name, path, icon, parentId, sort |
| `role` | è§’è‰²è¡¨ | id, name, code, description |
| `privilege` | æƒé™è¡¨ | id, name, code, type, url |
| `dept` | éƒ¨é—¨è¡¨ | id, name, parentId, sort |
| `article_tags_tag` | æ–‡ç« æ ‡ç­¾å…³è”è¡¨ | articleId, tagId |
| `user_roles_role` | ç”¨æˆ·è§’è‰²å…³è”è¡¨ | userId, roleId |

**ä¸»è¦å…³ç³»**ï¼š
- User 1:N Articleï¼ˆä¸€ä¸ªç”¨æˆ·å¤šç¯‡æ–‡ç« ï¼‰
- Article N:1 Categoryï¼ˆå¤šç¯‡æ–‡ç« å±äºä¸€ä¸ªåˆ†ç±»ï¼‰
- Article N:N Tagï¼ˆæ–‡ç« ä¸æ ‡ç­¾å¤šå¯¹å¤šï¼‰
- Article 1:N Commentï¼ˆä¸€ç¯‡æ–‡ç« å¤šæ¡è¯„è®ºï¼‰
- Comment 1:N Replyï¼ˆä¸€æ¡è¯„è®ºå¤šæ¡å›å¤ï¼‰
- User N:N Roleï¼ˆç”¨æˆ·ä¸è§’è‰²å¤šå¯¹å¤šï¼‰
- User N:1 Deptï¼ˆå¤šä¸ªç”¨æˆ·å±äºä¸€ä¸ªéƒ¨é—¨ï¼‰

**SQL åˆå§‹åŒ–è„šæœ¬**ï¼š[deploy/sql/init.sql](file:///d:/study/myGithub/blog-server/deploy/sql/init.sql)
- åŒ…å«å®Œæ•´çš„æ•°æ®åº“è¡¨ç»“æ„ï¼ˆ18 å¼ è¡¨ï¼‰
- åŒ…å«åˆå§‹è§’è‰²ã€æƒé™ã€èœå•ã€éƒ¨é—¨ç­‰åŸºç¡€æ•°æ®
- è¯¦ç»†è¯´æ˜è¯·æŸ¥çœ‹ä¸‹æ–‡ã€Œåˆå§‹åŒ–æ•°æ®ã€ç« èŠ‚

## ğŸŒ åœ¨çº¿é¢„è§ˆ

- **åšå®¢å‰å°**ï¼š[https://jiang-xia.top/](https://jiang-xia.top/)
- **ç®¡ç†åå°**ï¼š[https://admin.jiang-xia.top/](https://admin.jiang-xia.top/)
- **API æ–‡æ¡£**ï¼šhttps://jiang-xia.top/x-blog/api/v1/docï¼ˆéœ€éƒ¨ç½²åè®¿é—®ï¼‰

## ğŸ“¦ éƒ¨ç½²è¯´æ˜

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

**æ–¹å¼ä¸€ï¼šä¼ ç»Ÿéƒ¨ç½²ï¼ˆPM2ï¼‰**

1. **æ„å»ºé¡¹ç›®**
```bash
npm run build
```

2. **ä½¿ç”¨ PM2 å¯åŠ¨**
```bash
npm run pm2:prod
```

æˆ–ç›´æ¥ä½¿ç”¨ PM2 å‘½ä»¤ï¼š
```bash
pm2 start ecosystem.config.js --env production
```

PM2 å¸¸ç”¨å‘½ä»¤ï¼š
```bash
pm2 list              # æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹
pm2 logs blog-server  # æŸ¥çœ‹æ—¥å¿—
pm2 restart blog-server  # é‡å¯æœåŠ¡
pm2 stop blog-server     # åœæ­¢æœåŠ¡
pm2 delete blog-server   # åˆ é™¤è¿›ç¨‹
pm2 monit             # å®æ—¶ç›‘æ§
```

**æ–¹å¼äºŒï¼šDocker éƒ¨ç½²**

1. **æ„å»ºé•œåƒ**
```bash
docker build -t blog-server:latest .
```

2. **ä½¿ç”¨ docker-compose å¯åŠ¨**
```bash
docker-compose up -d
```

3. **æŸ¥çœ‹æ—¥å¿—**
```bash
docker-compose logs -f blog-server
```

**æ–¹å¼ä¸‰ï¼šNginx åå‘ä»£ç†**

é…ç½®ç¤ºä¾‹ï¼ˆ`config/nginx.conf`ï¼‰ï¼š
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location /api/v1/ {
        proxy_pass http://localhost:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }

    location /static/ {
        alias /path/to/blog-server/public/;
    }
}
```

### åˆå§‹åŒ–æ•°æ®

#### æ–¹å¼ä¸€ï¼šå¼€å‘ç¯å¢ƒè‡ªåŠ¨åˆå§‹åŒ–ï¼ˆæ¨èç”¨äºå¼€å‘æµ‹è¯•ï¼‰

**é…ç½®è¦æ±‚**ï¼š
- åœ¨ `.env.development` ä¸­è®¾ç½® `db_synchronize=true`
- ç¡®ä¿æ•°æ®åº“å·²åˆ›å»ºä½†è¡¨ä¸ºç©º

**æœåŠ¡ç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ“ä½œ**ï¼š

1. **åˆ›å»ºæ•°æ®åº“è¡¨ç»“æ„**
   - è‡ªåŠ¨æ ¹æ® Entity åˆ›å»ºæ‰€æœ‰æ•°æ®è¡¨
   - âš ï¸ ç”Ÿäº§ç¯å¢ƒåŠ¡å¿…è®¾ç½® `db_synchronize=false`

2. **åˆå§‹åŒ–é»˜è®¤ç®¡ç†å‘˜è´¦å·**
   - ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªé»˜è®¤ç®¡ç†å‘˜è´¦å·
   - é»˜è®¤æ‰‹æœºå·ï¼š`18888888888`
   - é»˜è®¤å¯†ç ï¼š`super`
   - é»˜è®¤è§’è‰²ï¼šä½œè€…ï¼ˆroleId: 3ï¼‰
   - é»˜è®¤éƒ¨é—¨ï¼šä½œè€…éƒ¨é—¨ï¼ˆdeptId: 4ï¼‰

**å¯åŠ¨æ—¥å¿—ç¤ºä¾‹**ï¼š
```
[Nest] INFO  æœåŠ¡å·²ç»å¯åŠ¨,æ¥å£è¯·è®¿é—®:http://127.0.0.1:5000/api/v1
[Nest] INFO  æœåŠ¡å·²ç»å¯åŠ¨,æ–‡æ¡£è¯·è®¿é—®:http://127.0.0.1:5000/api/v1/doc
[Nest] INFO  ç®¡ç†å‘˜è´¦æˆ·åˆ›å»ºæˆåŠŸï¼Œæ‰‹æœºå·ï¼š18888888888ï¼Œå¯†ç ï¼šsuperï¼Œè¯·åŠæ—¶ç™»å½•ç³»ç»Ÿä¿®æ”¹é»˜è®¤å¯†ç 
```

#### æ–¹å¼äºŒï¼šç”Ÿäº§ç¯å¢ƒä½¿ç”¨ SQL è„šæœ¬ï¼ˆæ¨èç”¨äºç”Ÿäº§éƒ¨ç½²ï¼‰

**æ­¥éª¤å¦‚ä¸‹**ï¼š

1. **å¯¼å…¥åˆå§‹åŒ–è„šæœ¬**
```bash
# è¿æ¥åˆ° MySQL æ•°æ®åº“
mysql -u your_username -p

# åˆ›å»ºæ•°æ®åº“
CREATE DATABASE IF NOT EXISTS myblog CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
USE myblog;

# å¯¼å…¥åˆå§‹åŒ–è„šæœ¬
source deploy/sql/init.sql;
```

2. **éªŒè¯æ•°æ®**
```bash
# æ£€æŸ¥è¡¨æ˜¯å¦åˆ›å»ºæˆåŠŸ
SHOW TABLES;

# æ£€æŸ¥åˆå§‹æ•°æ®
SELECT * FROM role;          # åº”åŒ…å« 3 ä¸ªè§’è‰²ï¼šè¶…çº§ç®¡ç†å‘˜ã€ç®¡ç†å‘˜ã€ä½œè€…
SELECT * FROM dept;          # åº”åŒ…å« 4 ä¸ªéƒ¨é—¨
SELECT * FROM privilege;     # åº”åŒ…å« 99 æ¡æƒé™æ•°æ®
SELECT * FROM menu;          # åº”åŒ…å«èœå•æ•°æ®
```

**init.sql è„šæœ¬åŒ…å«**ï¼š
- âœ… å®Œæ•´çš„æ•°æ®åº“è¡¨ç»“æ„ï¼ˆ18 å¼ è¡¨ï¼‰
- âœ… è§’è‰²æ•°æ®ï¼ˆè¶…çº§ç®¡ç†å‘˜ã€ç®¡ç†å‘˜ã€ä½œè€…ï¼‰
- âœ… éƒ¨é—¨æ•°æ®ï¼ˆé…±çš„åšå®¢ç³»ç»ŸåŠä¸‹å±éƒ¨é—¨ï¼‰
- âœ… æƒé™æ•°æ®ï¼ˆ99 æ¡æƒé™é…ç½®ï¼‰
- âœ… èœå•æ•°æ®ï¼ˆåå°ç®¡ç†èœå•ï¼‰
- âœ… è§’è‰²-æƒé™å…³è”æ•°æ®
- âœ… è§’è‰²-èœå•å…³è”æ•°æ®
- âœ… ç”¨æˆ·-è§’è‰²å…³è”æ•°æ®ç¤ºä¾‹

**æ³¨æ„äº‹é¡¹**ï¼š
- ğŸ“Œ è„šæœ¬ä¸åŒ…å«ç”¨æˆ·æ•°æ®ï¼Œé¦–æ¬¡å¯åŠ¨æœåŠ¡æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºé»˜è®¤ç®¡ç†å‘˜è´¦å·
- ğŸ“Œ ç”Ÿäº§ç¯å¢ƒå¿…é¡»è®¾ç½® `db_synchronize=false`ï¼Œé¿å…æ•°æ®è¡¨è¢«è‡ªåŠ¨ä¿®æ”¹
- ğŸ“Œ é¦–æ¬¡ç™»å½•åè¯·ç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç 

### ç¯å¢ƒå˜é‡è¯´æ˜

| å˜é‡å | è¯´æ˜ | ç¤ºä¾‹å€¼ |
|--------|------|--------|
| `NODE_ENV` | è¿è¡Œç¯å¢ƒ | `development` / `production` / `test` |
| `db_synchronize` | æ˜¯å¦è‡ªåŠ¨åŒæ­¥è¡¨ç»“æ„ | `true` / `false`ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…é¡»ä¸º falseï¼‰|
| `db_logging` | æ•°æ®åº“æ—¥å¿—çº§åˆ« | `error` / `query,error` |
| `serve_port` | æœåŠ¡ç«¯å£ | `5000` |
| `serve_baseUrl` | æœåŠ¡åŸºç¡€ URL | `http://your-domain.com` |
| `redis_host` | Redis ä¸»æœºåœ°å€ | `127.0.0.1` |
| `redis_port` | Redis ç«¯å£ | `6379` |

### æ•°æ®å¤‡ä»½

**MySQL æ•°æ®åº“å¤‡ä»½**ï¼š
```bash
# å¤‡ä»½
mysqldump -u username -p myblog > backup_$(date +%Y%m%d).sql

# æ¢å¤
mysql -u username -p myblog < backup_20260122.sql
```

**å¤‡ä»½ç›®å½•**ï¼š`backups/db-data/`

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å¯ç”¨ Redis ç¼“å­˜**ï¼šçƒ­ç‚¹æ•°æ®ç¼“å­˜ï¼ˆæ–‡ç« åˆ—è¡¨ã€ç»Ÿè®¡æ•°æ®ç­‰ï¼‰
2. **æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–**ï¼šä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•
3. **å¯ç”¨ Gzip å‹ç¼©**ï¼šNginx é…ç½® gzip
4. **CDN åŠ é€Ÿ**ï¼šé™æ€èµ„æºä½¿ç”¨ CDN
5. **æ—¥å¿—è½®è½¬**ï¼šä½¿ç”¨ PM2 æ—¥å¿—è½®è½¬åŠŸèƒ½
6. **é™æµä¿æŠ¤**ï¼šä½¿ç”¨ @nestjs/throttler é™åˆ¶è¯·æ±‚é¢‘ç‡

### å®‰å…¨å»ºè®®

1. âœ… ç”Ÿäº§ç¯å¢ƒå¿…é¡»è®¾ç½® `db_synchronize=false`
2. âœ… ä½¿ç”¨å¼ºå¯†ç ï¼Œå®šæœŸæ›´æ¢æ•°æ®åº“å¯†ç 
3. âœ… å¯ç”¨ HTTPSï¼ˆä½¿ç”¨ Let's Encryptï¼‰
4. âœ… é…ç½® CORS ç™½åå•
5. âœ… æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†é’¥ã€å¯†ç ï¼‰ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼Œä¸è¦æäº¤åˆ°ä»£ç ä»“åº“
6. âœ… å®šæœŸæ›´æ–°ä¾èµ–åŒ…ï¼ˆ`npm audit` æ£€æŸ¥æ¼æ´ï¼‰
7. âœ… é…ç½®é˜²ç«å¢™ï¼Œåªå¼€æ”¾å¿…è¦ç«¯å£

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'feat: Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ å¼€æºåè®®

æœ¬é¡¹ç›®åŸºäº [MIT](LICENSE) åè®®å¼€æºã€‚

## ğŸ‘¨â€ğŸ’» ä½œè€…

**jiang-xia**

- GitHub: [@jiang-xia](https://github.com/jiang-xia)
- Gitee: [@jiang-xia](https://gitee.com/jiang-xia)

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºè¿™ä¸ªé¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…ä»¬ï¼

---

<div align="center">
å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª â­ï¸ æ”¯æŒä¸€ä¸‹ï¼
</div>
